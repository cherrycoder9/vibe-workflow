자, 쿠키 다루는 방법 설명 들어간다. 웹 개발에서 쿠키는 "손님, 이거 기억해뒀다가 다음에 또 오시면 보여주세요!" 하고 브라우저에 작은 쪽지(정보)를 맡겨두는 기술이야.

**일반 쿠키 (Regular cookies)**

```typescript
app.get('/cookie', (c) => {
  // "cookie_name"이라는 이름으로 "cookie_value" 값을 가진 쿠키를 구워! (저장)
  setCookie(c, 'cookie_name', 'cookie_value')

  // 방금 구운 "cookie_name" 쿠키 맛 좀 볼까? (읽기)
  const yummyCookie = getCookie(c, 'cookie_name')

  // "cookie_name" 쿠키, 이제 안녕~ (삭제)
  deleteCookie(c, 'cookie_name')

  // 브라우저에 있는 모든 쿠키 다 내놔! (전체 읽기)
  const allCookies = getCookie(c)
  // ... 여기서 이제 쿠키 가지고 맘대로 요리하면 됨
})
```

**서명된 쿠키 (Signed cookies)**
**주의**: 서명된 쿠키를 설정하고 가져오는 건 WebCrypto API의 비동기 특성 때문에 `Promise`를 반환해. HMAC SHA-256 서명을 만드는 데 이 API가 쓰이거든. 그래서 `async/await` 짝꿍이랑 같이 써야 해.

```typescript
app.get('/signed-cookie', async (c) => { // async 키워드 주목!
  const secret = 'ultrasecretkeythatisverylongandsecure' // 비밀키. 보안을 위해 충분히 길고 복잡하게 만들어야 함!

  // "cookie_name0" 이름으로 "cookie_value" 값을 가진 쿠키에 비밀키로 서명해서 구워! (보안 저장)
  await setSignedCookie(c, 'cookie_name0', 'cookie_value', secret)

  // 비밀키로 서명된 "cookie_name0" 쿠키, 내용물 확인해볼까? (보안 읽기)
  const fortuneCookie = await getSignedCookie(
    c,
    secret, // 서명 풀 때도 같은 비밀키가 필요해
    'cookie_name0'
  )

  // "cookie_name0" 쿠키, 이제 진짜 안녕~ (삭제, 일반 쿠키 삭제랑 동일)
  deleteCookie(c, 'cookie_name0')

  // 만약 쿠키 서명이 조작됐거나 유효하지 않으면, `getSignedCookie`는 특정 쿠키에 대해 `false`를 반환할 거야.
  // 비밀키로 서명된 모든 쿠키 다 가져와! (전체 보안 읽기)
  const allSignedCookies = await getSignedCookie(c, secret)
  // ...
})
```

---

**얘네 뭐 하는 애들이냐?**
쿠키 관련 함수들은 웹 서버(Hono)랑 웹 브라우저(클라이언트)가 서로 "작은 정보 조각"을 주고받고, 저장하고, 꺼내 쓰고, 버릴 수 있게 해주는 도구 세트야.

*   `setCookie(c, 이름, 값, [옵션])`: 브라우저한테 "야, 이 쿠키 좀 저장해놔!" 하고 명령하는 거야. 이름이랑 값이 기본이고, 유효기간(`expires`), 사용 경로(`path`), 도메인(`domain`), 보안 연결 전용(`secure`), HTTP 전용(`httpOnly`), SameSite 정책(`sameSite`) 같은 옵션도 줄 수 있어.
*   `getCookie(c, [이름])`: 브라우저가 저장해둔 쿠키 중에서 특정 이름의 쿠키를 가져오거나, 이름을 안 주면 모든 쿠키를 몽땅 가져와. "전에 맡겨둔 쪽지 내놔봐."
*   `deleteCookie(c, 이름, [옵션])`: 특정 쿠키를 브라우저에서 삭제해. 보통 유효기간을 과거로 설정해서 없애버리지. "이 쿠키는 이제 필요 없어, 버려!"
*   `setSignedCookie(c, 이름, 값, 비밀키, [옵션])`: 일반 쿠키랑 똑같은데, 값에다가 서버만 아는 `비밀키`로 전자서명을 해서 저장해. 쿠키 내용이 중간에 누가 날치기해서 바꿔치기했는지 알아챌 수 있게 해주는 거지. "이거 내가 준 거 맞는지 도장 찍어둘게."
*   `getSignedCookie(c, 비밀키, [이름])`: 서명된 쿠키를 읽어올 때 쓰는 녀석. 저장할 때 썼던 그 `비밀키`로 서명을 검증해서, 만약 서명이 안 맞거나(누가 장난쳤거나) 없으면 "이거 가짜인데?" 하고 `false`나 `undefined`를 뱉어. 안전하게 쿠키 값을 쓰려면 필수!

**왜 쓰는데?**
1.  **사용자 기억하기 (세션 관리)**: 로그인하면 "님, 로그인하셨음" 하고 쿠키에 표시해뒀다가, 다음에 페이지 옮겨 다닐 때마다 "아, 이분 아까 로그인한 그분이네" 하고 알아보는 용도. 장바구니 정보 유지 같은 것도 이걸로 해.
2.  **개인화 설정 저장**: "다크 모드 좋아하심", "언어는 한국어로 설정하셨음" 같은 사용자 취향을 쿠키에 저장해뒀다가 다음에 다시 왔을 때 그대로 보여주는 거지.
3.  **추적 및 분석 (조심해서 써야 함)**: 사용자가 어떤 페이지들을 돌아다녔는지, 광고를 클릭했는지 같은 행동 패턴을 기록해서 마케팅이나 서비스 개선에 쓰기도 해. (개인정보보호 때문에 요즘은 좀 민감한 주제)
4.  **보안 (서명된 쿠키)**: 쿠키에 중요한 정보(예: 사용자 ID, 권한 정보)를 담을 때, 그 정보가 클라이언트나 중간자 공격에 의해 위변조되는 걸 막으려고 서명된 쿠키를 써. "내용물은 보여도, 함부로 고치진 못하게 하겠다!"

**언제 불려 나오냐?**
Hono 라우트 핸들러 안에서 `c` (컨텍스트 객체)랑 같이 쓰여.
*   로그인 성공 시 `setCookie`나 `setSignedCookie`로 "로그인 인증 토큰" 같은 걸 심어주고.
*   사용자가 페이지 요청할 때마다 `getCookie`나 `getSignedCookie`로 필요한 정보 꺼내 쓰고.
*   로그아웃하면 `deleteCookie`로 인증 토큰 지워버리고.

**쓸 때 꿀팁 및 주의사항:**
*   **쿠키 옵션, 그거슨 디테일**:
    *   `httpOnly: true`: 자바스크립트로 쿠키 접근 못하게 막아서 XSS 공격 방어에 도움 됨. 서버 통신용 쿠키면 웬만하면 켜. "자바스크립트, 넌 못 지나간다!"
    *   `secure: true`: HTTPS 연결일 때만 쿠키 전송. 민감 정보 담긴 쿠키면 필수. "안전한 길로만 다니렴."
    *   `path` & `domain`: 쿠키가 유효한 경로랑 도메인 지정. 잘못 설정하면 쿠키가 엉뚱한 데서 읽히거나 안 읽힐 수 있음.
    *   `expires` vs `maxAge`: `expires`는 만료 날짜 지정, `maxAge`는 지금부터 몇 초 동안 유효할지 지정. 둘 다 안 주면 브라우저 닫으면 사라지는 "세션 쿠키"가 됨.
    *   `sameSite: 'Strict' | 'Lax' | 'None'`: CSRF 공격 방어랑 서드파티 쿠키 제한 관련 설정. `None` 쓰려면 `secure: true`도 같이 써야 함. 복잡하니까 잘 알아보고 써.
*   **서명된 쿠키의 `secret`은 진짜 비밀이어야 함**: `secret` 키 유출되면 서명된 쿠키는 그냥 일반 쿠키랑 다를 바 없어짐. 환경 변수로 관리하고, 절대 코드에 하드코딩하거나 깃허브에 올리지 마. "비밀번호는 금고에!"
*   **쿠키 크기 제한**: 브라우저마다 쿠키 하나당, 도메인당 저장할 수 있는 쿠키 개수랑 총 크기에 제한이 있어. 보통 4KB 정도인데, 너무 많은 정보 때려 넣으면 짤리거나 저장 안 될 수 있음. "욕심부리면 쿠키 터진다."
*   **개인정보보호 규정 (GDPR, CCPA 등)**: 쿠키, 특히 추적용 쿠키 쓸 때는 사용자 동의를 받아야 하는 경우가 많아. 법규 잘 확인하고 "쿠키 동의 배너" 같은 거 달아야 할 수도. "법은 지키라고 있는 거다."
*   **`await` 빼먹지 마 (서명된 쿠키)**: `setSignedCookie`, `getSignedCookie`는 비동기 함수라 `await` 안 붙이면 쿠키가 제대로 설정/조회되기 전에 다음 코드가 실행돼서 "왜 안 되지?" 하고 머리 싸맬 수 있음. "비동기는 기다림의 미학."
*   **디버깅은 개발자 도구로**: 브라우저 개발자 도구(F12)의 Application 탭(Chrome 기준)에서 현재 사이트에 저장된 쿠키들 까볼 수 있으니까, 문제 생기면 여기서 확인해봐. "범인은 이 안에 있다!"