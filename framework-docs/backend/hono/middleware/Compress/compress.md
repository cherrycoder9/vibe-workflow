`hono/compress`에서 `compress`를 가져옵니다.

```typescript
import { Hono } from 'hono'
import { compress } from 'hono/compress'
```

이 미들웨어는 `Accept-Encoding` 요청 헤더에 따라 응답 본문을 압축합니다.

**정보**

*   참고: Cloudflare Workers 및 Deno Deploy에서는 응답 본문이 자동으로 압축되므로 이 미들웨어를 사용할 필요가 없습니다.
*   Bun: 이 미들웨어는 `CompressionStream`을 사용하는데, 이는 아직 Bun에서 지원되지 않습니다.

**사용법**

```typescript
const app = new Hono()

// 모든 경로에 대해 compress 미들웨어를 적용!
app.use(compress())
```

**옵션**

*   `encoding: 'gzip' | 'deflate'` (선택 사항)
    *   응답 압축에 사용할 압축 방식을 지정합니다. `gzip` 또는 `deflate` 중 하나를 선택할 수 있습니다.
    *   정의되지 않으면 둘 다 허용되며 `Accept-Encoding` 헤더를 기반으로 사용됩니다. 이 옵션이 제공되지 않고 클라이언트가 `Accept-Encoding` 헤더에 둘 다 제공하면 `gzip`이 우선적으로 사용됩니다.
*   `threshold: number` (선택 사항)
    *   압축을 수행할 최소 크기(바이트 단위)입니다. 기본값은 1024바이트입니다.

---

**얘 뭐 하는 애냐?**
`compress` 미들웨어는 서버가 클라이언트에게 응답을 보낼 때, 그 내용물(주로 HTML, JSON, CSS, JS 파일 등 텍스트 기반 데이터)을 꾸욱 눌러서 부피를 줄여주는 역할을 해. 마치 "이삿짐 싸는데, 옷가지들 진공팩에 넣어 부피 확 줄이는 기술" 같은 거지. 클라이언트가 "나 압축된 것도 받을 수 있어!" (`Accept-Encoding` 헤더에 `gzip`이나 `deflate` 같은 걸 명시) 하고 알려주면, 서버가 "오케이, 그럼 압축해서 보내줄게!" 하고 응답하는 거야.

**왜 쓰는데?**
1.  **데이터 전송량 감소 = 속도 향상 & 비용 절감**: 응답 데이터 크기가 작아지니까 클라이언트가 더 빨리 받을 수 있고, 서버 입장에서는 네트워크 트래픽 비용을 아낄 수 있어. 특히 모바일 환경처럼 네트워크가 느리거나 데이터 요금에 민감한 사용자에게 아주 좋지. "택배 상자 작아지면 배송비도 싸지는 이치!"
2.  **사용자 경험(UX) 개선**: 웹페이지 로딩 속도가 빨라지니까 사용자들이 덜 지루해하고 사이트 이탈률도 줄어들 수 있어. "로딩 바만 쳐다보는 건 이제 그만!"

**언제 불려 나오냐?**
Hono 앱에서 `app.use(compress())`처럼 전역 미들웨어로 등록하거나, 특정 경로에만 `app.use('/api/*', compress())` 같이 적용할 수 있어. 응답을 보내기 직전에 "어? 이거 압축할 수 있겠는데?" 싶으면 내용물을 압축해서 내보내는 거지.

**쓸 때 꿀팁 및 주의사항:**
*   **플랫폼 자동 압축 확인**: 네 설명에도 나와 있듯이, Cloudflare Workers나 Deno Deploy 같은 똑똑한 플랫폼들은 알아서 응답을 압축해주는 경우가 많아. 이럴 땐 `compress` 미들웨어를 또 쓰면 괜히 일 두 번 하는 셈이니 빼는 게 나아. "이미 누가 청소했는데 또 청소기 돌리는 격."
*   **Bun 환경에서는 아직...**: Bun에서는 `CompressionStream` 지원이 아직이라 이 미들웨어가 제대로 안 돌 수 있다는 점 기억해둬. (2025년 5월 현재 기준, 나중에 지원될 수도 있으니 공식 문서를 항상 확인하는 게 좋아.)
*   **`encoding` 옵션**: 굳이 `gzip`이나 `deflate` 중 하나만 고집할 필요는 없어. 기본 설정대로 두면 클라이언트가 지원하는 방식 중 더 효율적인 걸 알아서 선택해 주니까. (보통 `gzip`이 더 널리 쓰이고 무난해.)
*   **`threshold` 옵션으로 똑똑하게 압축**: 아주 작은 데이터는 압축하는 게 오히려 비효율적일 수 있어 (압축/해제하는 데 드는 CPU 자원이 더 아까움). `threshold` 옵션으로 "최소 이 정도 크기는 돼야 압축한다!" 하고 기준을 정해두면 좋아. 기본값 1KB(1024바이트) 정도면 대부분 괜찮아. "모기 잡는데 대포 쏠 필요 없잖아?"
*   **이미 압축된 파일은 압축 안 함**: JPEG, PNG 같은 이미지 파일이나 MP4 영상, ZIP 파일 등은 이미 자체적으로 압축되어 있어서 이런 애들한테 또 압축 걸어봤자 효과도 없고 시간만 낭비야. `compress` 미들웨어도 보통 이런 애들은 알아서 건너뛰거나, `Content-Type` 헤더를 보고 판단할 거야.
*   **CPU 사용량과의 트레이드오프**: 압축은 공짜가 아니야. 서버 CPU 자원을 써서 데이터를 압축하는 거라, 트래픽이 어마어마하게 많은 서비스라면 압축으로 인한 CPU 부하도 고려해야 해. 물론 대부분의 경우엔 네트워크 대역폭 절감 이득이 훨씬 크지만. "세상에 공짜 점심은 없다."
*   **디버깅 시 주의**: 개발자 도구에서 네트워크 탭 볼 때, 압축된 응답은 내용이 깨져 보일 수 있어. 브라우저가 알아서 해제해서 보여주긴 하지만, 가끔 "왜 내용이 이상하지?" 싶을 땐 압축 때문일 수 있다는 걸 염두에 둬.