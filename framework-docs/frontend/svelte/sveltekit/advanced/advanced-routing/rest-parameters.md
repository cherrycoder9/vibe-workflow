**나머지 매개변수 (Rest Parameters)**

라우트 경로의 일부가 몇 개가 될지 모를 때, 나머지 매개변수 문법을 사용합니다. 예를 들어 깃허브 파일 뷰어 같은 걸 만든다고 칩시다.

`/[org]/[repo]/tree/[branch]/[...file]`

이렇게 해두면, `/sveltejs/kit/tree/main/documentation/docs/04-advanced-routing.md` 같은 주소로 요청이 들어왔을 때, 페이지에서 다음과 같은 매개변수들을 쓸 수 있게 됩니다:

```json
{
  "org": "sveltejs",
  "repo": "kit",
  "branch": "main",
  "file": "documentation/docs/04-advanced-routing.md"
}
```

`[...file]` 부분이 나머지 경로를 통째로 먹어버린 거죠. "어디까지가 네 영역인지 모르겠으니, 일단 다 가져가!" 이런 느낌입니다.

`src/routes/a/[...rest]/z/+page.svelte` 같은 라우트는 `/a/z` (즉, `[...rest]` 부분이 아예 없음) 뿐만 아니라 `/a/b/z`, `/a/b/c/z` 등등 전부 다 잡아냅니다. 그러니까 `[...rest]` 매개변수 값이 유효한지, 예를 들어 매처(matcher) 같은 걸 써서 꼭 확인해야 합니다. 안 그러면 이상한 경로까지 다 허용해버리는 수가 있어요.

---

**얘 뭐 하는 애냐?**

SvelteKit의 나머지 매개변수(`[...이름]`)는 URL 경로에서 특정 부분 뒤에 오는 모든 경로 조각들을 하나의 매개변수로 묶어서 받아오는 기능입니다. 마치 함수의 나머지 매개변수(`...args`)처럼, "이 뒤로는 몇 개가 오든 다 네 거다!" 하고 퉁쳐서 처리할 때 씁니다. 특히 파일 경로처럼 깊이가 유동적이거나, 여러 단계의 카테고리를 한 번에 처리하고 싶을 때 유용하죠. "경로계의 진공청소기"라고나 할까요.

**왜 쓰는데?**

1.  **유동적인 경로 처리:** 위 깃허브 예시처럼 파일 탐색기 만들 때, 파일 경로가 `/docs/a.md`일 수도 있고 `/very/deep/nested/path/to/file.md`일 수도 있잖아요? 이럴 때 `[...file]` 하나로 깔끔하게 처리 가능합니다. "경로가 아무리 길어져도 걱정 마, 내가 다 받아줄게!"
2.  **와일드카드 라우팅:** 특정 접두사로 시작하는 모든 경로를 하나의 페이지에서 처리하고 싶을 때 씁니다. 예를 들어 `/blog/[...slug]`는 `/blog/my-first-post`, `/blog/category/tech/awesome-article` 등을 모두 잡아낼 수 있죠.
3.  **커스텀 404 페이지 (아래에서 자세히):** 특정 경로 하위에서 발생하는 404 에러를 좀 더 세밀하게 제어하고 싶을 때 이놈을 활용합니다.

**언제 불려 나오냐?**

사용자가 브라우저에 URL을 입력하거나 링크를 클릭했을 때, SvelteKit 라우터가 등록된 경로 패턴들과 대조합니다. 이때 `[...이름]` 패턴이 포함된 라우트가 현재 URL과 일치하면, 해당 `+page.svelte`나 `+server.js` 파일의 `load` 함수 또는 API 핸들러가 호출되면서, `params` 객체 안에 나머지 경로 부분이 통째로 담겨 전달됩니다.

**쓸 때 꿀팁 및 주의사항:**

*   **욕심은 금물, 한 놈만 패!:** 하나의 경로 세그먼트 안에서는 나머지 매개변수를 딱 하나만 쓸 수 있습니다. `/[...a]/fixed/[...b]` 이런 건 안 됩니다. "뷔페 가서 한 접시에 다 담으려 하지 마라."
*   **위치가 중요해:** 나머지 매개변수는 보통 경로 패턴의 맨 마지막에 둡니다. 중간에 끼워 넣으면 라우터가 헷갈려서 "이게 맞나?" 싶어 합니다. `/[...prefix]/user/[id]` 보다는 `user/[id]/[...suffix]` (만약 이런 구조가 필요하다면) 같은 식이 더 일반적이지만, 사실상 맨 뒤에 쓰는 게 국룰입니다.
*   **값 검증은 필수 코스:** `[...rest]`로 받은 값은 그냥 문자열 덩어리입니다. 이게 진짜 파일 경로인지, 아니면 해커가 이상한 거 집어넣은 건지 알 수 없어요. 반드시 매처(matcher)를 쓰거나 `load` 함수 안에서 유효성 검사를 철저히 해야 합니다. "아무거나 주워 먹으면 배탈 난다!" 예를 들어 파일 경로라면 `../` 같은 상위 디렉토리 접근 시도 같은 건 막아야겠죠.
*   **비어 있을 수도 있음을 인지:** `src/routes/a/[...rest]/z/+page.svelte` 예시처럼, `[...rest]` 부분이 아예 없는 경로(`a/z`)도 매칭될 수 있습니다. 이 경우 `params.rest`는 `undefined`가 됩니다. 코딩할 때 이 부분 고려 안 하면 "왜 안 되지?" 하면서 머리 뜯게 됩니다.
*   **우선순위:** 일반적인 동적 매개변수(`[param]`)보다 나머지 매개변수(`[...param]`)가 포함된 라우트가 우선순위가 낮게 매칭되는 경향이 있습니다. 즉, 더 구체적인 라우트가 먼저 선택됩니다. 하지만 너무 복잡하게 꼬아놓으면 개발자 본인도 헷갈리니, 구조는 최대한 단순하게 가져가는 게 좋습니다.

---

**404 페이지 (404 pages)**

나머지 매개변수는 커스텀 404 페이지를 보여줄 때도 써먹을 수 있습니다. 예를 들어 다음과 같은 라우트 구조가 있다고 칩시다:

```
src/routes/
├ marx-brothers/
│ ├ chico/
│ ├ harpo/
│ ├ groucho/
│ └ +error.svelte  // marx-brothers 하위 에러 담당
└ +error.svelte      // 최상위 에러 담당
```

이 상태에서 `/marx-brothers/karl` (칼 마르크스는 마르크스 형제가 아니죠!)로 접속하면, `marx-brothers/+error.svelte`가 아니라 최상위 `+error.svelte`가 렌더링됩니다. 왜냐하면 `/marx-brothers/karl`에 딱 맞는 라우트가 없어서 SvelteKit이 "이건 내 관할 아님" 하고 상위로 넘겨버리기 때문입니다.

만약 `/marx-brothers/` 하위의 없는 페이지에 대해 `marx-brothers/+error.svelte`를 보여주고 싶다면, `/marx-brothers/*` 형태의 모든 요청을 잡아내는 라우트를 만들고, 거기서 404 에러를 직접 발생시켜야 합니다:

```
src/routes/
├ marx-brothers/
| ├ [...path]/       // 이놈이 /marx-brothers/ 하위의 모든 경로를 일단 잡음
│ ├ chico/
│ ├ harpo/
│ ├ groucho/
│ └ +error.svelte
└ +error.svelte
```

그리고 `src/routes/marx-brothers/[...path]/+page.svelte` (또는 `+page.server.js`, `+server.js`) 파일에서 이렇게 코딩합니다:

```typescript
// src/routes/marx-brothers/[...path]/+page.js (또는 .ts)
import { error } from '@sveltejs/kit';
import type { PageLoad } from './$types';

export const load: PageLoad = (event) => {
  // 여기서 뭔가 복잡한 로직으로 path가 유효한지 체크할 수도 있지만,
  // 일단 이 라우트에 걸렸다는 건 chico, harpo, groucho가 아니란 뜻이므로
  // 그냥 404를 던져버린다.
  error(404, 'Not Found');
};
```

이렇게 하면 `/marx-brothers/` 하위의 정의되지 않은 경로로 접근 시, `marx-brothers/+error.svelte`가 "어이, 거기 아니야!" 하면서 나타나게 됩니다.

만약 404 케이스를 이렇게 따로 처리 안 하면, 에러는 `handleError` 훅으로 넘어가서 처리됩니다.

---

**얘 뭐 하는 애냐?**

SvelteKit에서 404 (페이지 없음) 에러가 났을 때, 사용자에게 "야, 너 주소 잘못 찾아왔어!"라고 알려주는 페이지를 보여주는 방식에 대한 설명입니다. 기본적으로 SvelteKit은 가장 가까운 `+error.svelte` 파일을 찾아서 보여주는데, 나머지 매개변수를 쓰면 특정 경로 그룹에 대한 404 페이지를 좀 더 디테일하게 지정할 수 있다는 게 핵심입니다. "우리 집 강아지가 없어졌을 땐 우리 동네 전단지를, 옆집 강아지가 없어졌을 땐 옆집 동네 전단지를 붙여야지!"

**왜 쓰는데?**

1.  **사용자 경험 (UX) 향상:** 밋밋한 기본 404 페이지 대신, 웹사이트 디자인에 맞춰 예쁘고 유용한 안내가 담긴 404 페이지를 보여줄 수 있습니다. "길 잃은 사용자에게 한 줄기 빛을!"
2.  **세분화된 에러 처리:** 예를 들어 `/admin` 경로 하위에서 없는 페이지를 접근했을 때와, 일반 사용자용 `/shop` 경로 하위에서 없는 페이지를 접근했을 때, 서로 다른 안내와 디자인의 404 페이지를 보여주고 싶을 수 있습니다. 나머지 매개변수를 쓰면 이런 "맞춤형 길 안내"가 가능해집니다.
3.  **디버깅 및 로깅:** 특정 경로 그룹에서 404가 발생했을 때, 해당 `[...path]/+page.js`의 `load` 함수에서 어떤 경로로 접근했는지 로그를 남기거나 추가적인 분석을 할 수 있습니다. "범인은 이 안에 있어! 어떤 놈이 이상한 주소로 들어온 거야?"

**언제 불려 나오냐?**

1.  사용자가 존재하지 않는 URL로 접근했을 때, SvelteKit 라우터는 가장 먼저 해당 URL 패턴에 맞는 `[...path]/+page.svelte` (또는 `+page.server.js`, `+server.js`) 같은 "모든 걸 다 받는" 라우트가 있는지 찾습니다.
2.  만약 그런 라우트가 있고, 그 안의 `load` 함수나 API 핸들러에서 `error(404, '메시지')`를 호출하면, SvelteKit은 해당 라우트가 속한 디렉토리 또는 그 상위 디렉토리에서 가장 가까운 `+error.svelte` 파일을 찾아서 렌더링합니다.
3.  만약 `[...path]` 같은 캐치올(catch-all) 라우트가 없거나, 있어도 거기서 `error(404)`를 명시적으로 호출하지 않으면, SvelteKit은 그냥 일반적인 라우트 매칭 실패로 간주하고 가장 가까운 상위 `+error.svelte`를 찾거나, 그것도 없으면 루트 `+error.svelte`를, 그것마저 없으면 SvelteKit 기본 404 페이지를 보여줍니다.

**쓸 때 꿀팁 및 주의사항:**

*   **`error()` 함수는 SvelteKit에서 제공하는 것!:** `import { error } from '@sveltejs/kit';` 해서 써야 합니다. 그냥 `throw new Error()`랑은 다릅니다. `error()`는 SvelteKit이 알아먹고 적절한 에러 페이지로 연결해주는 약속된 방식입니다. "우리끼리 쓰는 암구호 같은 거라고!"
*   **`[...path]` 라우트의 위치:** `marx-brothers/[...path]/+page.svelte`는 `marx-brothers/chico/+page.svelte` 같은 구체적인 라우트보다 뒤에 (파일 시스템상으로는 같은 레벨이지만, 라우팅 우선순위에서 밀리도록) 정의되어야 합니다. 안 그러면 `[...path]`가 모든 걸 다 가로채서 `chico` 페이지가 영원히 안 뜰 수도 있습니다. SvelteKit은 보통 파일 이름 정렬 순서 등을 고려해서 우선순위를 정하지만, 헷갈릴 수 있으니 폴더 구조를 명확히 하는 게 좋습니다. (사실 SvelteKit은 더 구체적인 경로를 우선하므로 대부분 잘 동작하지만, 너무 믿진 마세요.)
*   **`+error.svelte`는 형제 또는 부모 디렉토리에:** `error(404)`가 호출되면, SvelteKit은 해당 `+page.svelte` 파일이 있는 디렉토리의 `+error.svelte`를 먼저 찾습니다. 없으면 부모 디렉토리로 올라가면서 찾습니다. 루트까지 갔는데도 없으면 SvelteKit 기본 에러 페이지가 나옵니다. "가족(같은 폴더)부터 챙기고, 없으면 어른(상위 폴더)한테 물어봐라."
*   **상태 코드와 메시지:** `error(404, '페이지를 찾을 수 없어요! 딴 데 가보세요.')`처럼 상태 코드(404)와 함께 사용자에게 보여줄 메시지를 전달할 수 있습니다. 이 메시지는 `+error.svelte`의 `$page.error.message`로 접근 가능합니다.
*   **`handleError` 훅과의 관계:** `[...path]`에서 `error(404)`를 호출해서 처리하는 건, 해당 경로 그룹에 대한 "지역적" 404 처리입니다. 만약 이런 처리가 없거나 다른 종류의 에러가 발생하면, 전역적인 에러 처리를 담당하는 `src/hooks.server.js` (또는 `.client.js`)의 `handleError` 훅으로 넘어가게 됩니다. "동네 파출소에서 해결 안 되면 경찰서로 가는 거지."