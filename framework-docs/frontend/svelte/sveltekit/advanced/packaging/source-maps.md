Source maps (소스맵)

`tsconfig.json` 파일에서 `"declarationMap": true`로 설정하면 이른바 선언 맵(`.d.ts.map` 파일)이라는 걸 만들 수 있어. 이걸 쓰면 VS Code 같은 편집기에서 "정의로 이동(Go to Definition)" 같은 기능을 쓸 때, 빌드된 `.d.ts` 파일 대신 원본 `.ts` 파일이나 `.svelte` 파일로 바로 점프시켜주는 마법을 부리지.

이게 제대로 작동하려면, 네가 만든 라이브러리의 빌드 결과물인 `dist` 폴더와 함께 원본 소스 파일도 같이 배포해야 돼. 왜냐하면 선언 맵 파일 안에 적힌 상대 경로가 네 패키지를 설치한 사람의 `node_modules` 폴더 내에서 실제 디스크에 있는 원본 파일로 정확하게 연결되어야 하거든. 만약 네 라이브러리 코드가 스벨트 CLI가 추천하는 대로 `src/lib` 폴더 안에 다 들어있다면, `package.json` 파일의 `files` 항목에 `src/lib`를 추가하는 것만큼이나 간단하게 해결할 수 있어.

```json
{
	"files": [
		"dist",
		"!dist/**/*.test.*",
		"!dist/**/*.spec.*",
		"src/lib",
		"!src/lib/**/*.test.*",
		"!src/lib/**/*.spec.*"
	]
}
```

---

**얘 뭐 하는 애냐?**
소스맵, 특히 타입스크립트 세상에서는 "선언 맵(`.d.ts.map`)"이라고 불리는 놈이야. 우리가 타입스크립트나 스벨트 같은 걸로 코딩하면 결국 자바스크립트로 변환되잖아? 라이브러리 사용자 입장에서는 변환된 `.d.ts` 파일(타입 정의 파일)을 보고 "이 타입 대체 원본 어디서 온 거임?" 하고 궁금할 때가 있는데, 그때 이 선언 맵이 "저짝 원본 `.ts`나 `.svelte` 파일인데요?" 하고 친절하게 안내해주는 네비게이션 같은 역할이야. "길치 개발자를 위한 GPS"랄까.

**왜 쓰는데?**
1.  **개발 경험 수직 상승:** 라이브러리 쓰는 사람이 "정의로 이동" 눌렀을 때, 암호문 같은 `.d.ts` 파일 대신 익숙한 원본 `.ts`나 `.svelte` 코드가 뜨면 얼마나 편하겠어? "이거 만든 사람 최소 배우신 분" 소리 듣는 거지. 디버깅할 때도 실제 로직이 담긴 원본을 봐야 감이 빨리 오잖아.
2.  **코드 이해도 UP:** 다른 사람이 만든 라이브러리 쓸 때, 타입 정의만 봐서는 전체 그림이 잘 안 그려질 수 있어. 원본 소스를 바로 볼 수 있으면 "아하, 이래서 이 타입이 나왔구나!" 하고 이해하기 훨씬 쉽지. "백문이 불여일견, 백번 타입 보는 것보다 한 번 원본 보는 게 낫다."
3.  **라이브러리 기여 장벽 완화:** 오픈소스 라이브러리 같은 경우, 다른 개발자들이 코드 수정하거나 기여하려고 할 때 원본 코드로 바로 이동할 수 있으면 분석 시간 확 줄어들지. "어서 와, 우리 집은 처음이지? 길 안 잃게 해줄게."

**언제 불려 나오냐?**
주로 타입스크립트로 라이브러리를 만들어서 다른 개발자들에게 배포할 때 써먹어. `tsconfig.json`에 `"declaration": true` (이게 있어야 `.d.ts` 파일이 생김)랑 `"declarationMap": true`를 같이 켜고 빌드하면, `.d.ts` 파일 옆에 짝꿍처럼 `.d.ts.map` 파일이 생성돼. 그럼 라이브러리 사용자의 IDE가 이 맵 파일을 보고 원본 소스로 안내해주는 거지.

**쓸 때 꿀팁 및 주의사항:**
*   **원본 소스 파일은 필수 지참:** `.d.ts.map` 파일만 덩그러니 있고 원본 소스 파일(`.ts`, `.svelte`)이 없으면 "앙꼬 없는 찐빵"이야. `package.json`의 `files` 배열에 `dist` 폴더(빌드 결과물)랑 `src/lib` 폴더(원본 소스)를 같이 넣어줘야 npm에 배포할 때 제대로 딸려 올라가. 예시처럼 테스트 파일(`*.test.*`, `*.spec.*`)은 빼주는 센스!
*   **경로 설정은 생명:** `declarationMap` 파일 안에 기록된 원본 파일 경로는 네 패키지가 설치될 `node_modules` 폴더 내에서의 상대 경로 기준이야. 이게 꼬이면 "지도 보고 찾아갔는데 허허벌판" 되는 수가 있어. `tsconfig.json`의 `rootDir`(소스 루트), `outDir`(빌드 결과물 폴더) 설정이랑 `package.json`의 `files` 설정을 잘 맞춰야 해.
*   **패키지 용량? 쬐끔 늘어남:** 원본 소스랑 맵 파일까지 같이 배포하니까 당연히 패키지 용량은 좀 늘어나겠지. 근데 요즘 세상에 그 정도 용량은 개발 편의성이랑 비교하면 혜자 수준이야. "개발자들 편하자고 쓰는 건데, 용량 몇 KB에 쫄지 마라."
*   **`.npmignore` vs `package.json` `files`:** 뭘 배포하고 뭘 뺄지 확실히 정해야 해. `package.json`의 `files`는 화이트리스트 방식(여기 적힌 것만 포함)이라 좀 더 명시적이야. 괜히 빌드 스크립트나 로컬 설정 파일 같은 거 딸려 보내서 사용자들 헷갈리게 하지 말자고.
*   **"내 라이브러리는 소중하니까" (보안 아님):** 이건 소스 코드를 '보호'하는 기능이 아니야. 오히려 더 잘 '보여주기' 위한 기능이지. "우리 코드 이렇게 깔끔하고 좋다! 많이들 보러 와라!" 하는 용도에 가까워.