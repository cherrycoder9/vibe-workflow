`data-sveltekit-preload-data`

브라우저가 "아, 이 양반이 링크 눌렀구나!" 하고 알아채기 전에, 우리는 이미 사용자가 마우스 커서를 링크 위에 올려놨거나(데스크탑), 화면을 터치하기 시작했거나(모바일), 마우스를 누르기 시작했다는 걸 감지할 수 있어. 두 경우 모두 "어? 이거 곧 클릭 각인데?" 하고 합리적 추측을 때릴 수 있다는 거지.

SvelteKit은 이 정보를 이용해서 코드 가져오고 페이지 데이터 미리 땡겨오는 데 선빵을 날릴 수 있어. 덕분에 몇백 밀리초를 벌 수 있는데, 이게 바로 사용자가 느끼기에 "아오, 왜 이리 버벅여!"와 "오, 겁나 빠릿빠릿한데?"를 가르는 차이야.

이 동작은 `data-sveltekit-preload-data` 속성으로 컨트롤할 수 있고, 값은 두 가지 중 하나를 쓸 수 있어:

*   `"hover"`: 마우스가 링크 위에 잠시 머무르면 미리 로딩 시작. 모바일에선 `touchstart` (화면 터치 시작) 이벤트 때 시작.
*   `"tap"`: `touchstart`나 `mousedown` (마우스 버튼 누름) 이벤트가 등록되자마자 미리 로딩 시작.

기본 프로젝트 템플릿에는 `src/app.html` 파일의 `<body>` 태그에 `data-sveltekit-preload-data="hover"`가 박혀있어. 그래서 기본적으로 모든 링크는 마우스 올리면 미리 로딩되는 거야.

```html
<body data-sveltekit-preload-data="hover">
	<div style="display: contents">%sveltekit.body%</div>
</body>
```

가끔은 사용자가 링크 위에 마우스 올렸다고 바로 `load` 함수 호출하는 게 별로일 때가 있어. 클릭으로 이어지지 않는 김칫국 드링킹일 가능성이 높거나, 데이터가 너무 빨리 바뀌어서 미리 땡겨온 데이터가 금방 상해버릴 수 있거든.

이럴 땐 `"tap"` 값을 쓰면 돼. 그럼 사용자가 링크를 진짜 탭하거나 클릭했을 때만 SvelteKit이 `load` 함수를 호출해.

```html
<a data-sveltekit-preload-data="tap" href="/stonks">
	지금 바로 떡상/떡락 주식 현황 보기
</a>
```

아니면 `$app/navigation`에 있는 `preloadData` 함수를 써서 코드 레벨에서 직접 미리 로딩을 실행할 수도 있어.

만약 사용자가 "데이터 아껴 쓰기 모드" (즉, `navigator.connection.saveData`가 `true`인 상황)를 켜놨으면 데이터는 절대 미리 로딩되지 않아.

---

**얘 뭐 하는 애냐?**
`data-sveltekit-preload-data`는 한마디로 "예지력 상승템"이야. 사용자가 링크를 클릭하기도 전에 "아, 저거 누르겠네" 싶으면 미리 해당 페이지 코드랑 데이터를 슬쩍 가져와서 로딩 시간을 줄여주는 녀석이지. "손님, 주문하실 거죠? 미리 준비해뒀습니다!" 이런 느낌.

**왜 쓰는데?**
사용자 경험(UX)을 극적으로 끌어올리기 위해서지. 페이지 이동이 눈 깜짝할 사이에 이뤄지는 것처럼 느껴지게 만들어서, 사용자가 "와, 이 사이트 빠르네!" 하고 감탄하게 만드는 게 목표야. 느려터진 사이트는 이제 그만!

**언제/어떻게 쓰는 거냐?**
HTML 태그에 속성으로 박아주면 돼. 보통은 `<body>` 태그에 전체 적용하거나, 특정 `<a>` 태그에 개별적으로 설정해.
*   `data-sveltekit-preload-data="hover"`: 마우스 올리거나 터치 시작하면 바로 작업 개시.
*   `data-sveltekit-preload-data="tap"`: 마우스 클릭 시작하거나 탭 하는 순간 작업 개시.
기본값은 `<body>`에 "hover"로 설정되어 있어서 웬만한 링크는 알아서 미리 로딩해.

**쓸 때 꿀팁 및 주의사항:**
*   **"hover" vs "tap", 그것이 문제로다:**
    *   `"hover"`: 빠르긴 한데, 사용자가 그냥 마우스만 쓱 지나가도 미리 로딩하니까 서버 자원 낭비(김칫국)나 너무 자주 바뀌는 데이터는  stale 해질 수 있음. "일단 받고 보자!" 스타일.
    *   `"tap"`: "hover"보단 한발 늦지만, 확실히 누를 것 같을 때 움직이니까 자원 낭비가 적고 데이터 신선도 유지에 유리. "신중하게 가자." 스타일.
*   **데이터 폭주 주의보:** 데이터가 엄청 크거나, API 호출 비용이 비싸거나, 너무 자주 호출하면 안 되는 페이지에는 "hover"를 남발하지 않는 게 좋아. 특히 데이터가 실시간으로 변하는 주식 정보 같은 건 "tap"이 현명할 수 있지. "아무 생각 없이 hover 박으면 서버비 폭탄 맞는다!"
*   **데이터 절약 모드 존중:** 사용자가 `navigator.connection.saveData` 켜놨으면 이 기능은 자동으로 꺼져. 사용자의 소중한 데이터를 아껴주는 착한 기능이니 걱정 마.
*   **프로그래밍 방식 호출도 가능:** `$app/navigation`의 `preloadData('/경로')` 함수를 쓰면 특정 상황에 맞춰 개발자가 직접 코드 실행 시점에 미리 로딩을 명령할 수 있어. "내가 원할 때, 원하는 것만!"
*   **모든 링크에 다 걸 필요는 없다:** 외부 링크나 파일 다운로드 링크 같은 데는 굳이 이거 안 써도 돼. SvelteKit 내부 페이지 이동에만 효과적이야.