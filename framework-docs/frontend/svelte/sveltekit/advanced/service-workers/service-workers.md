**Service workers**

이놈들은 네 앱 안에서 돌아가는 프록시 서버 같은 거야. 네트워크 요청을 중간에서 가로채서 처리하지. 덕분에 앱이 오프라인에서도 작동하게 만들 수 있어. 설령 오프라인 지원이 딱히 필요 없거나 (만드는 앱 종류에 따라 현실적으로 구현하기 힘들 수도 있지만), 빌드된 자바스크립트(JS)랑 CSS 파일을 미리 캐싱해서 페이지 이동 속도를 높이는 데 써먹을 만해. "미리 받아놓고 빨리빨리 보여주겠다 이거지."

스벨트킷(SvelteKit)에서는 `src/service-worker.js` 파일이나 `src/service-worker/index.js` 파일을 만들어두면 알아서 번들링하고 등록까지 해줘. 서비스 워커 파일 위치를 바꾸고 싶으면 그것도 가능하고.

만약 네가 직접 서비스 워커를 등록하는 로직을 짜고 싶거나 다른 솔루션을 쓰고 싶다면, 이 자동 등록 기능을 꺼버릴 수도 있어. 기본적으로 등록되는 코드는 대충 아래처럼 생겼어:

```javascript
if ('serviceWorker' in navigator) { // 브라우저가 서비스 워커 지원하는지 확인
	addEventListener('load', function () { // 페이지 로드 다 되면 실행
		navigator.serviceWorker.register('./path/to/service-worker.js'); // 서비스 워커 파일 등록
	});
}
```

---

**얘 뭐 하는 애냐?**
서비스 워커는 웹 브라우저 백그라운드에서 돌아가는 스크립트야. 웹페이지랑은 별개로 작동하면서 네트워크 요청 가로채기, 푸시 알림, 백그라운드 동기화 같은 고급 기능을 수행하지. 쉽게 말해 웹앱의 "보이지 않는 손" 같은 존재랄까? "니들 모르게 뒤에서 열일한다!"

**왜 쓰는데?**
1.  **오프라인 지원:** 이게 핵심 기능 중 하나야. 네트워크 연결 끊겨도 미리 캐싱해둔 자원들로 앱을 계속 쓸 수 있게 해줘. 비행기 모드에서도 돌아가는 웹앱? 얘가 있으면 가능해. "인터넷 없다고 징징대지 마라, 내가 있잖아."
2.  **성능 향상 (캐싱):** 자주 쓰는 파일들(JS, CSS, 이미지 등)을 캐시에 저장해뒀다가 필요할 때 바로 꺼내 쓰니까 로딩 속도가 빨라져. 특히 페이지 이동할 때 체감 효과가 크지. "로딩 기다리다 속 터지는 일은 이제 그만."
3.  **푸시 알림:** 서버에서 보낸 푸시 메시지를 받아서 사용자에게 알림을 띄울 수 있어. 앱을 닫아둔 상태에서도 알림을 받을 수 있다는 게 장점이지. "사장님, 새 주문 들어왔어요! (앱 안 켜도 알려줌)"
4.  **백그라운드 동기화:** 네트워크 연결이 불안정할 때 사용자가 뭔가 작업을 하면(예: 메시지 전송), 일단 로컬에 저장해뒀다가 나중에 연결되면 자동으로 서버에 보내는 기능도 구현할 수 있어. "지금 안 보내져도 걱정 마, 연결되면 내가 알아서 보낼게."

**언제 불려 나오냐? (등록 과정)**
보통 웹페이지가 로드될 때 자바스크립트로 서비스 워커 파일을 등록(`navigator.serviceWorker.register()`)해. 한번 등록되면 브라우저가 서비스 워커를 설치하고 활성화시켜. 그 후로는 해당 서비스 워커의 범위(scope) 내에서 발생하는 네트워크 요청 등을 감시하고 제어할 수 있게 돼.

**쓸 때 꿀팁 및 주의사항:**
*   **HTTPS는 필수:** 보안 때문에 서비스 워커는 HTTPS 환경에서만 작동해. 개발 중일 때는 `localhost`에서도 돌아가지만, 실제 서비스하려면 SSL 인증서 박아야 한다. "http:// 에서는 꿈도 꾸지 마라."
*   **캐싱 전략이 중요:** 뭘 얼마나 캐싱하고, 언제 업데이트할 건지 잘 정해야 해. 잘못하면 사용자가 옛날 버전만 계속 보거나, 캐시가 너무 커져서 브라우저 용량만 잡아먹는 수가 있어. "무지성 캐싱은 재앙을 부른다." `stale-while-revalidate`, `cache-first`, `network-first` 같은 다양한 전략이 있으니 공부 좀 해야 할 거야.
*   **업데이트 골치 아픔:** 서비스 워커 파일 자체가 업데이트되면 브라우저가 이걸 감지하고 새 버전으로 교체하는데, 이 과정이 좀 까다로울 수 있어. 사용자가 탭을 다 닫았다가 다시 열어야 새 서비스 워커가 활성화되는 경우도 있고. "새 옷 갈아입는 게 생각보다 귀찮다."
*   **디버깅 쉽지 않음:** 백그라운드에서 돌아가다 보니 일반적인 자바스크립트 디버깅보다 좀 더 복잡해. 브라우저 개발자 도구에 있는 서비스 워커 탭(Application 탭 > Service Workers)을 잘 활용해야 해. "숨어있는 놈 잡기가 원래 더 어렵다."
*   **스코프(Scope)를 이해해라:** 서비스 워커는 특정 경로 범위 내에서만 작동해. `/app/` 아래에 등록하면 `/app/` 하위 경로에만 영향을 미치지, `/blog/`에는 간섭 안 해. "내 구역은 내가 지킨다."
*   **모든 브라우저가 100% 지원하는 건 아님 (하지만 대부분 지원):** 최신 브라우저들은 거의 다 지원하지만, 아주 구형 브라우저에서는 안 될 수도 있으니 `if ('serviceWorker' in navigator)` 체크는 기본이야. "IE : ...?" (물론 IE는 이제 거의 안 쓰지만)
*   **스벨트킷 자동 등록 편하긴 한데...:** `src/service-worker.js`만 만들면 알아서 해주는 건 편하지만, 복잡한 로직이 필요하거나 특정 조건에서만 등록하고 싶다면 자동 등록 끄고 직접 `navigator.serviceWorker.register()` 호출하는 게 나을 수도 있어. "자동이 항상 능사는 아니다."