에러는 소프트웨어 개발에서 피할 수 없는 숙명 같은 겁니다. SvelteKit은 에러가 어디서 터졌는지, 어떤 종류의 에러인지, 그리고 들어오는 요청의 성격이 뭔지에 따라 다르게 처리합니다.

**에러 객체**

SvelteKit은 **예상된 에러**와 **예상치 못한 에러**를 구분하는데, 둘 다 기본적으로는 `{ message: string }` 형태의 단순한 객체로 표현됩니다.

아래 예시처럼 `code`나 `tracking id` 같은 추가 속성을 덧붙일 수도 있습니다. (타입스크립트 쓰고 있다면, 타입 안전성 설명 부분에 나온 대로 `Error` 타입을 새로 정의해야 이 짓이 가능합니다.)

---

**얘 뭐 하는 애냐?**

SvelteKit에서 에러 처리가 어떻게 돌아가는지에 대한 기본 설명입니다. 핵심은 "예상했냐, 못했냐?"로 에러를 나눈다는 것과, 에러 정보는 기본적으로 `{ message: "에러 메시지" }` 꼴로 전달된다는 겁니다. "문제 생겼을 때 어떻게 알려줄지 정하는 룰" 같은 거죠.

**왜 쓰는데?**

1.  **일관된 에러 처리:** 어디서 에러가 나든, 일단 `{ message: "..." }` 형태로 통일해서 다루니까 개발자가 에러 정보를 파악하고 대응하기 편해집니다. "야, 에러 나면 무조건 이 양식으로 보고해!"
2.  **에러 유형 구분:** "이건 터질 줄 알았다" 싶은 에러(예: 사용자가 입력 잘못함)랑 "아니, 이게 왜 터져?" 싶은 에러(예: 코드 버그, 서버 맛탱이 감)를 구분해서, 상황에 맞게 다른 방식으로 사용자에게 보여주거나 로그를 남길 수 있게 합니다.
3.  **추가 정보 첨부 가능:** 단순 메시지 외에 에러 코드(`404`, `500` 등)나 내부 추적 ID 같은 걸 붙여서 디버깅하거나 사용자에게 더 구체적인 피드백을 줄 수 있습니다. "그냥 '망했어요' 하지 말고, '왜', '어떻게' 망했는지도 알려달라고!"

**언제 불려 나오냐? (SvelteKit 내부적으로)**

*   `+error.svelte` 파일이나 `handleError` 훅에서 에러 객체를 다룰 때, 이 기본 구조를 따릅니다.
*   `@sveltejs/kit`에서 제공하는 `error` 헬퍼 함수를 써서 개발자가 직접 "예상된 에러"를 발생시킬 때, 이 객체 형태로 에러를 던집니다.
*   예상치 못한 에러가 코드 어딘가에서 뻥 터졌을 때, SvelteKit이 그걸 잡아서 이 객체 형태로 가공한 뒤 에러 처리 로직으로 넘깁니다.

**쓸 때 꿀팁 및 주의사항:**

*   **`message`는 필수, 나머지는 옵션:** 에러 객체에 `message` 속성은 무조건 있어야 합니다. 다른 건 필요에 따라 넣거나 빼면 됩니다.
*   **타입스크립트 사용자 주목!:** 기본 `Error` 타입에는 `message` 밖에 없습니다. `code` 같은 거 추가하려면 `App.Error` 인터페이스를 프로젝트의 `app.d.ts` 파일 같은 데서 직접 확장해야 타입 에러 안 납니다. "타입스크립트 형씨, 이건 직접 정의하셔야 합니다."
*   **보안 생각해서 민감 정보는 빼세요:** 사용자에게 보여줄 에러 메시지에는 데이터베이스 비밀번호나 시스템 내부 경로 같은 민감한 정보가 절대 들어가면 안 됩니다. "고객님께 내부 사정까지 다 까발릴 필요는 없잖아요?" 서버 로그에만 자세히 남기고, 사용자에게는 "문제가 발생했습니다. 관리자에게 문의하세요 (에러 코드: XXX)" 정도로 퉁치는 게 안전빵입니다.
*   **예상된 에러 vs 예상치 못한 에러:**
    *   **예상된 에러:** 사용자가 일부러 이상한 짓을 하거나(예: 없는 페이지 요청), 폼 입력값이 잘못된 경우 등 개발자가 미리 "이런 상황엔 에러다"라고 정의한 경우입니다. `@sveltejs/kit`의 `error(status, { message })` 함수로 직접 던집니다. 사용자에게 친절한 안내 메시지를 보여주는 용도죠.
    *   **예상치 못한 에러:** 코드 버그, 외부 API 장애, 데이터베이스 연결 실패 등 개발자가 예상 못한 진짜 문제 상황입니다. 이건 보통 500번대 에러로 처리되고, 사용자에게는 "죄송합니다. 서버에 문제가 생겼습니다" 같은 일반적인 메시지를 보여주고, 개발자는 로그를 통해 원인을 파악해야 합니다. "이건 진짜 큰일 난 거니까, 일단 사용자 진정시키고 뒷수습부터 하자!"