**Responses (응답)**

`handle` 함수나 `+server.js` 요청 핸들러 안에서 에러가 터지면, SvelteKit은 요청의 `Accept` 헤더를 보고 판단합니다. 브라우저가 HTML 페이지를 원하면 (보통 그렇죠) 미리 준비된 "폴백 에러 페이지"를 보여주고, 만약 프로그램이 API 응답처럼 JSON 데이터를 원하면 에러 객체를 JSON 형태로 깔끔하게 보내줍니다. "손님, HTML 드릴까요, JSON 드릴까요?" 하는 거죠.

이 "폴백 에러 페이지"는 `src/error.html` 파일을 만들어서 내 입맛대로 꾸밀 수 있어요. 예를 들면 이렇게요:

```html
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>%sveltekit.error.message%</title> <!-- 에러 메시지가 제목으로 뙇! -->
	</head>
	<body>
		<h1>나만의 커스텀 에러 페이지</h1>
		<p>상태: %sveltekit.status%</p> <!-- 몇 번 에러인지 (404, 500 등) -->
		<p>메시지: %sveltekit.error.message%</p> <!-- 왜 에러났는지 -->
	</body>
</html>
```

여기서 `%sveltekit.status%`랑 `%sveltekit.error.message%` 부분은 SvelteKit이 실제 에러 상태 코드랑 메시지로 알아서 바꿔치기 해줍니다. "변수명만 써두면 알아서 채워드림!"

그런데 만약 페이지를 화면에 그리는 도중에 (즉, `load` 함수 안에서) 에러가 발생하면, SvelteKit은 그 에러가 난 곳에서 가장 가까이에 있는 `+error.svelte` 컴포넌트를 찾아서 보여줍니다. 좀 더 세련된 에러 처리가 가능한 거죠. 만약 `+layout.js`나 `+layout.server.js` 안에 있는 `load` 함수에서 에러가 터지면, 그 레이아웃 파일 바로 옆에 있는 `+error.svelte`가 아니라, 그 레이아웃보다 한 단계 위(부모 디렉토리)에 있는 `+error.svelte` 파일이 이 에러를 잡아서 처리합니다. "에러는 옆집이 아니라 윗집에서 해결한다!"

딱 한 가지 예외 상황이 있는데, 바로 애플리케이션의 맨 꼭대기, 즉 루트 `+layout.js`나 `+layout.server.js`의 `load` 함수에서 에러가 터졌을 때입니다. 보통 이 루트 레이아웃이 모든 페이지의 기본 틀이 되고, 그 안에 `+error.svelte` 컴포넌트도 포함되는 구조거든요. 그래서 이런 경우에는 `+error.svelte`를 쓰지 않고, 위에서 말한 `src/error.html` 폴백 에러 페이지를 사용합니다. "최상위 보스가 쓰러지면 비상 메뉴얼대로!"

---

**얘 뭐 하는 애냐?**
SvelteKit이 에러 상황에 따라 사용자에게 "어이쿠, 문제 생겼네!" 하고 보여줄 화면(HTML 페이지든, API 응답이든)을 어떻게 내보낼지, 그리고 그 화면을 어떻게 꾸밀 수 있는지 정해놓은 규칙이야. 한마디로 "에러 화면 담당 매니저" 같은 역할이지. 상황에 맞춰서 적절한 에러 안내를 해주는 똑똑한 녀석이라고.

**왜 쓰는데?**
1.  **상황별 맞춤 에러 제공:** 사용자가 웹 페이지를 보려 할 때(HTML)와 프로그램이 데이터를 요청할 때(JSON)는 원하는 응답 형식이 다르잖아? 이걸 SvelteKit이 알아서 구분해서, HTML 요청에는 보기 좋은 에러 페이지를, JSON 요청에는 프로그램이 이해하기 쉬운 에러 데이터를 보내줘. "TPO에 맞는 에러 응대, 기본 중의 기본이지."
2.  **일관되고 전문적인 에러 화면:** `src/error.html`이나 각 라우트별 `+error.svelte`를 사용해서 우리 앱/웹사이트의 디자인 톤앤매너를 유지하는 에러 페이지를 보여줄 수 있어. 쌩뚱맞은 기본 에러 화면 대신, 사용자에게 "아, 여기는 이런 사소한 부분까지 신경 쓰는구나" 하는 인상을 줄 수 있지. "에러 화면도 브랜딩이다, 이 말씀이야."
3.  **부분 장애 격리 및 사용자 경험 향상:** 페이지 전체가 아니라 특정 데이터 로딩(`load` 함수)에서만 문제가 생겼을 때, `+error.svelte`를 통해 해당 부분만 에러 상태임을 알리고 나머지는 정상적으로 보여줄 수 있어. 페이지 전체가 먹통 되는 것보다 훨씬 낫잖아? "발목 삐었다고 온몸에 깁스할 순 없지."

**언제 불려 나오냐?**
주로 서버 사이드 로직, 즉 `handle` 함수, `+server.js`로 만든 API 엔드포인트, 또는 페이지나 레이아웃의 `load` 함수 내부에서 예기치 않은 에러가 푱 하고 터졌을 때 등판해. 이때 요청 헤더의 `Accept` 값을 보고 HTML을 원하면 `src/error.html` 또는 가장 가까운 `+error.svelte`를, `application/json`을 원하면 JSON 객체를 응답으로 보내줘.

**쓸 때 꿀팁 및 주의사항:**
*   **`src/error.html`은 최후의 보루:** 이건 진짜 다른 방법이 없을 때나, 루트 레이아웃 `load`처럼 아주 근본적인 부분에서 에러 났을 때 보여주는 거야. 웬만하면 각 페이지나 레이아웃 폴더 안에 `+error.svelte` 파일을 만들어서 좀 더 구체적이고 상황에 맞는 에러 메시지를 보여주는 게 사용자 경험에 훨씬 좋아. "비상 탈출구는 항상 준비하되, 자주 쓰진 말자."
*   **`+error.svelte`는 위계질서가 중요:** `+layout.js`의 `load` 함수에서 에러가 나면, 그 레이아웃 파일과 같은 레벨에 있는 `+error.svelte`가 아니라, 그 상위 디렉토리(부모)에 있는 `+error.svelte`가 에러를 처리한다는 점! 이거 헷갈리면 "왜 내가 만든 에러 페이지 안 뜨지?" 하고 삽질할 수 있어. "에러 처리는 직속 상사에게 보고!"
*   **루트 `load` 에러는 무조건 `src/error.html`:** 애플리케이션 전체의 기본 틀이 되는 루트 `+layout.js` 또는 `+layout.server.js`의 `load` 함수에서 에러가 발생하면, 다른 `+error.svelte` 다 필요 없고 무조건 `src/error.html`이 나선다는 거 잊지 마. 여기는 그래서 아주 일반적이고 포괄적인 에러 안내 내용을 담아야 해.
*   **API(`+server.js`) 에러는 JSON이 국룰:** `+server.js`에서 에러 났다고 HTML 태그 덕지덕지 붙은 에러 페이지 던져주면 API 쓰는 쪽에서 욕한다. 깔끔하게 `{ "error": { "message": "뭔가 잘못됐어요", "code": "ERR_SOMETHING_WRONG" } }` 이런 식으로 구조화된 JSON 에러 객체를 반환하는 게 예의야.
*   **`%sveltekit.status%`와 `%sveltekit.error.message%` 외 정보 활용:** `src/error.html`에서는 이 두 가지 플레이스홀더만 기본으로 제공돼. 만약 에러에 대한 더 자세한 정보를 `src/error.html`에 보여주고 싶다면, `handleError` 훅 같은 곳에서 추가 정보를 `event.locals` 같은 곳에 담아두고, `src/error.html`을 렌더링할 때 서버에서 이 값을 읽어와서 HTML에 주입하는 식으로 좀 더 복잡한 처리가 필요할 수 있어. (근데 이건 좀 고급 스킬이니, 일단 기본부터 잘 쓰자고.)