# SvelteKit SSR Deep Dive

원래 스벨트킷(SvelteKit)은 페이지를 서버에서 먼저 렌더링하고 그 HTML을 클라이언트로 보내서 하이드레이션(hydration, 페이지에 생명력을 불어넣는 과정)을 거쳐. 근데 `ssr` 옵션을 `false`로 설정하면, 서버는 그냥 텅 빈 껍데기 페이지만 렌더링해서 보내줘. 이건 네 페이지가 서버에서 도저히 렌더링될 수 없을 때 (예를 들어 `document` 같은 브라우저 전용 전역 변수를 써야 할 때) 유용하긴 한데, 대부분의 상황에서는 별로 추천하지 않아 (왜 그런지는 부록 찾아보라고).

`+page.js` (또는 `+layout.js`) 파일에 아래처럼 코드를 넣으면 돼:
```javascript
export const ssr = false;
```
뼈 때리는 주석 하나 달자면, 만약 `ssr`이랑 `csr` (Client Side Rendering) 둘 다 `false`면? 아무것도 렌더링 안 된다! 그냥 화면 먹통되는 거야. "둘 다 끄면 뭐 어쩌자는 거냐?"

만약 네 앱의 루트 `+layout.js` 파일에 `export const ssr = false;`를 박아버리면, 앱 전체가 오직 클라이언트에서만 렌더링돼. 이건 뭐 사실상 네 앱을 SPA(Single Page Application)로 만들어버리는 거랑 똑같은 거지. "서버는 거들 뿐, 모든 건 브라우저에서!"

만약 네 모든 페이지 옵션들이 단순한 불리언(true/false) 값이나 문자열 리터럴이면, 스벨트킷은 이걸 정적으로, 즉 빌드할 때 미리 평가해버릴 거야. 근데 그게 아니라면? 서버에서 네 `+page.js`나 `+layout.js` 파일을 직접 임포트해서 (빌드 시점에도 그렇고, 네 앱이 완전히 정적이지 않다면 사용자가 접속하는 런타임에도) 옵션 값을 알아내려고 할 거야. 이 두 번째 경우에는, 모듈이 로드되는 시점에 브라우저 전용 코드가 실행되면 서버에서 에러 뿜으니까 절대 안 돼. 실질적으로 이건 뭐냐? 브라우저에서만 돌아가는 코드는 `+page.svelte`나 `+layout.svelte` 파일 안에서, 예를 들면 `onMount` 같은 생명주기 함수 안에서 임포트하거나 실행해야 한다는 소리야. "서버는 `window`가 뭔지 모른다, 이 친구야."

---

**얘 뭐 하는 애냐? (기능 설명)**
스벨트킷에서 서버 사이드 렌더링(SSR)을 켜고 끌 수 있게 하는 스위치 같은 거야. `true`면 서버가 HTML을 다 만들어서 보내주고 (기본값), `false`면 서버는 "난 모르겠다, 브라우저 네가 알아서 그려라" 하고 빈 껍데기만 던져주는 거지.

**왜 쓰는데? (목적)**
*   `ssr = true` (기본값): 첫 페이지 로딩 속도를 빠르게 하고, 검색 엔진 최적화(SEO)에도 유리해. "사용자도 좋아하고 구글신도 좋아하는 방법이지."
*   `ssr = false`: 서버에서는 실행할 수 없는 브라우저 전용 코드(예: `document`, `window` 객체 접근)를 페이지 초기 렌더링에 꼭 써야 할 때, 또는 그냥 "난 무조건 SPA!"를 외치고 싶을 때 사용해.

**언제 불려 나오냐? (호출/동작 시점)**
*   **빌드 시점**: 스벨트킷이 네 코드에서 `export const ssr = ...` 이 부분을 읽고 정적으로 값을 파악하려고 해.
*   **요청 시점 (서버)**: 사용자가 페이지를 요청하면, 이 `ssr` 값에 따라 서버가 HTML을 직접 만들지(true), 아니면 빈 껍데기만 보낼지(false) 결정해.
*   **요청 시점 (클라이언트)**: `ssr = true`였다면 서버가 보내준 HTML에 자바스크립트로 생명을 불어넣는 하이드레이션 작업을 하고, `ssr = false`였다면 클라이언트가 처음부터 모든 걸 다 그려.

**쓸 때 꿀팁 및 주의사항:**
*   **`ssr = false`는 신중하게**: SEO 점수 깎아 먹고, 사용자가 첫 화면 보기까지 더 오래 걸릴 수 있어. "특별한 이유 없으면 그냥 기본값 써라. 그게 국룰이다."
*   **브라우저 전용 코드는 격리 필수**: `ssr = true`일 때 `+page.js`나 `+layout.js`의 최상단에서 `window` 같은 거 쓰면 서버에서 바로 에러 터진다. 이런 코드는 `onMount` 안이나, `if (browser)` 조건문 안에서만 사용해야 안전빵이야. `browser`는 `$app/environment`에서 가져올 수 있어. "서버는 `window` 창문이 아니라 진짜 서버라고!"
*   **`csr`과의 콤비 플레이**: `export const csr = true;` (기본값)는 클라이언트 사이드 렌더링 및 하이드레이션을 할지 말지를 결정해. 만약 `ssr = false`인데 `csr = false`까지 해버리면? 그냥 빈 화면 당첨. "아무것도 안 하겠다는 강력한 의지!"
*   **전역 SPA 전환**: 앱 전체를 SPA로 만들고 싶으면 루트 `+layout.js`에 `export const ssr = false;`를 선언해. 특정 페이지만 그렇게 하고 싶으면 해당 `+page.js`에만 넣어.
*   **성능 체크는 필수**: `ssr` 옵션 건드렸으면 실제로 얼마나 빨라졌는지, 혹은 느려졌는지 꼭 테스트해봐. "느낌만 믿지 말고, 숫자를 봐라."
*   **"부록 참고"의 의미**: 원문에서 "see appendix"라고 한 건, "더 자세한 건 공식 문서 파봐라, 거기 다 있다"는 뜻이야. 괜히 있는 말이 아니니, 궁금하면 SvelteKit 공식 문서를 정독하는 게 좋아.