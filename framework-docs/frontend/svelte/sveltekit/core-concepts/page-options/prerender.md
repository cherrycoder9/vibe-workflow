자, "prerender"에 대해 알아보자. 이거 잘 쓰면 사이트 속도 빨라지고 서버 비용도 아낄 수 있는 꿀기능이다.

**prerender (미리 렌더링하기)**

네 앱의 일부 라우트(페이지)들은 빌드할 때 미리 간단한 HTML 파일로 만들어 둘 수 있을 거야. 이런 페이지들을 "미리 렌더링한다(prerender)"고 해.

**어떻게 쓰냐?**
`+page.js`, `+page.server.js`, 또는 `+server.js` 파일 안에다가 이렇게 써주면 돼:

```javascript
export const prerender = true;
```

아니면, 앱 전체를 기본적으로 미리 렌더링하고 특정 페이지만 제외하고 싶으면, 최상위 `+layout.js`나 `+layout.server.js`에 `export const prerender = true;`를 박아놓고, 미리 렌더링 안 할 페이지만 골라서 이렇게 설정하면 돼:

```javascript
export const prerender = false;
```

`prerender = true`로 설정된 라우트들은 동적 서버 사이드 렌더링(SSR)에 필요한 목록에서 빠져. 그래서 네 서버나 서버리스/엣지 함수 용량이 줄어드는 효과가 있지.

근데 가끔은 이런 경우도 있어. 예를 들어 `/blog/[slug]` 같은 블로그 글 페이지가 있는데, 최근 글이나 인기 글은 미리 렌더링해두고, 나머지는 사용자가 요청할 때 서버에서 만들고 싶을 수 있잖아? 이런 "일부는 미리, 일부는 나중에" 같은 상황을 위해 세 번째 옵션, 'auto'가 있어:

```javascript
export const prerender = 'auto';
```

만약 네 앱 전체가 미리 렌더링하기에 적합하다면, `adapter-static`이라는 걸 쓰면 돼. 이건 어떤 정적 웹서버에서도 돌릴 수 있는 파일들을 만들어줘. "그냥 HTML 덩어리들로 구워버리는 거지."

미리 렌더링하는 녀석(prerenderer)은 앱의 루트(/)부터 시작해서, 미리 렌더링 가능한 페이지나 `+server.js` 라우트를 찾아서 파일을 생성해. 각 페이지에서는 다른 페이지로 연결되는 `<a>` 태그들을 스캔해서 다음에 뭘 미리 렌더링할지 찾아. 그래서 보통은 "이 페이지, 저 페이지 미리 만들어줘" 하고 일일이 지정할 필요가 없어. 그래도 꼭 지정해야 한다면 `config.kit.prerender.entries` 옵션을 쓰거나, 동적 라우트 파일에서 `entries` 함수를 export 하면 돼.

미리 렌더링하는 동안에는 `$app/environment`에서 가져온 `building` 변수 값이 `true`가 된다. "나 지금 빌드 중임! 건들지 마!" 이런 신호 같은 거지.

---

**얘 뭐 하는 애냐?**
`prerender`는 웹사이트 페이지를 사용자가 접속하기 전에, 즉 빌드하는 시점에 미리 HTML 파일로 만들어두는 기능이야. 사용자가 "이 페이지 보여줘!" 하기 전에 이미 완성된 HTML이 떡하니 준비되어 있으니, 로딩 속도가 빛처럼 빨라지는 마법을 부릴 수 있지. "손님 오시기 전에 상 다 차려놓는 식당"이라고 생각하면 돼.

**왜 쓰는데?**
1.  **속도 개선:** 이미 만들어진 HTML을 바로 보여주니까 사용자가 느끼는 로딩 속도가 엄청나게 빨라져. 특히 내용이 자주 바뀌지 않는 페이지(소개 페이지, 자주 묻는 질문 등)에 딱이지. "누르자마자 뿅!"
2.  **서버 부하 감소:** 사용자가 요청할 때마다 서버가 페이지를 새로 만들 필요가 없으니 서버가 할 일이 줄어들어. 트래픽이 몰려도 서버가 덜 힘들어하고, 비용도 절감될 수 있어. "서버야, 이제 좀 쉬어도 돼."
3.  **SEO 향상:** 검색엔진 봇이 HTML 내용을 바로 긁어갈 수 있어서 사이트 구조를 더 잘 이해하고 검색 결과에도 긍정적인 영향을 줄 수 있어. "검색엔진님, 여기 맛집 정보 다 있습니다."
4.  **정적 호스팅 가능:** 모든 페이지를 미리 렌더링하면 복잡한 서버 없이 GitHub Pages나 Netlify 같은 정적 호스팅 서비스에 그냥 파일만 올려서 사이트를 운영할 수 있어. "서버 관리는 귀찮다! 파일만 올리고 끝내자."

**언제 불려 나오냐?**
개발자가 `export const prerender = true;` (또는 `'auto'`) 설정을 해둔 페이지나 API 라우트에 대해, `npm run build` 같은 빌드 명령을 실행할 때 스벨트킷 빌드 과정에서 내부적으로 이 prerenderer가 돌아가.

**쓸 때 꿀팁 및 주의사항:**
*   **아무 페이지나 다 `prerender = true` 박으면 안 돼:** 사용자마다 내용이 달라지거나(예: 마이페이지), 실시간 데이터가 필요한 페이지(예: 주식 현재가)는 미리 렌더링하면 안 되겠지? "김 아무개님 마이페이지를 미리 구워놓으면 이 아무개님이 보면 난리 난다."
*   **`'auto'`는 만능이 아니다:** `'auto'` 옵션은 해당 페이지로 들어오는 링크가 있고, 그 페이지가 서버 사이드에서만 돌아가는 `load` 함수가 없을 때 주로 미리 렌더링돼. 상황이 복잡하면 의도대로 안 될 수도 있으니, 빌드 결과물을 꼭 확인해야 해.
*   **동적 파라미터가 있는 라우트 (예: `/blog/[slug]`)는 `entries` 함수가 필요할 수 있어:** 스벨트킷이 어떤 `[slug]` 값들에 대해 미리 HTML을 만들어야 할지 모르니까, `entries` 함수로 "이런 slug들에 대해 미리 만들어줘" 하고 알려줘야 해. 예를 들어 `['post-1', 'post-2']` 이런 식으로.
*   **빌드 시간 증가:** 미리 렌더링할 페이지가 많으면 당연히 빌드 시간이 길어져. "빨리 먹으려면 미리 준비하는 시간이 필요한 법."
*   **`$app/environment`의 `building` 활용:** 미리 렌더링 중일 때만 실행하거나 실행하지 말아야 할 코드가 있다면 `building` 변수를 써서 분기 처리할 수 있어.
*   **`adapter-static`은 신중하게:** 앱 전체를 정적으로 만들 때 쓰는 건데, 조금이라도 서버 사이드 로직이 필요한 부분이 있다면 못 써. "내 앱은 100% 순수 HTML이다!" 할 때만 고려해.