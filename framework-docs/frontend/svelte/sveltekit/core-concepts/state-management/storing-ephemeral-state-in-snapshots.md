**Storing ephemeral state in snapshots (스냅샷에 임시 상태 저장하기)**

아코디언 메뉴가 열려있는지 닫혀있는지 같은 일부 UI 상태는 일회용이야. 사용자가 다른 페이지로 가거나 새로고침하면 그 상태가 날아가도 별 상관없지. 근데 어떤 경우에는 사용자가 다른 페이지 갔다가 다시 돌아왔을 때 그 상태가 유지되길 원할 수도 있어. 그렇다고 이런 자잘한 상태까지 URL에 쑤셔 넣거나 데이터베이스에 저장하는 건 좀 과하잖아? "닭 잡는 데 소 잡는 칼 쓸 순 없지."

이럴 때 쓰라고 스벨트킷이 '스냅샷(snapshots)'이라는 기능을 제공해. 이걸 쓰면 컴포넌트 상태를 브라우저의 방문 기록(history entry)이랑 연결시킬 수 있어.

---

**얘 뭐 하는 애냐?**
"Storing ephemeral state in snapshots"는 말 그대로 잠깐 있다 사라질 만한 UI 상태들, 예를 들면 "이 아코디언 메뉴 열렸나?", "스크롤 위치 어디까지 내렸더라?" 같은 것들을 브라우저의 '뒤로 가기/앞으로 가기' 기록에 살짝 묻어두는 기능이야. 사용자가 페이지를 왔다 갔다 할 때 마치 원래 그 상태였던 것처럼 자연스럽게 복원해 주지. "야, 너 아까 보던 데부터 다시 봐." 이런 느낌.

**왜 쓰는데?**
1.  **사용자 경험 (UX) 향상:** 사용자가 실수로 다른 페이지 갔다가 "아차!" 하고 돌아왔을 때, 방금까지 보던 화면 상태 그대로 복원해주면 얼마나 편하겠어? 스크롤 위치, 열어뒀던 탭, 입력하던 폼 내용(일부) 같은 걸 기억해 주면 사용자는 "오, 이 사이트 센스 있네?" 하게 돼.
2.  **개발 편의성:** 이런 자잘한 상태까지 URL이나 DB에 꾸역꾸역 저장하려면 코드도 복잡해지고 관리 포인트만 늘어나. 스냅샷은 간단하게 이런 임시 상태를 처리할 수 있게 해줘. "귀찮은 건 스벨트킷한테 맡겨."
3.  **성능:** URL에 모든 상태를 다 때려 박으면 URL이 너무 길어지고 지저분해져. DB를 쓰면 네트워크 요청이 추가로 필요할 수도 있고. 스냅샷은 브라우저 자체 기능을 활용하니까 비교적 가볍게 쓸 수 있어.

**언제 불려 나오냐?**
컴포넌트 내에서 `capture`라는 함수를 통해 현재 상태를 저장하고, `restore` 함수를 통해 복원해. 주로 사용자가 페이지를 떠나기 직전(`beforeunload` 같은 시점은 아니지만, 스벨트킷 라우팅 라이프사이클에 맞춰서)에 `capture`가 호출되고, 사용자가 '뒤로 가기' 등으로 다시 돌아왔을 때 해당 컴포넌트가 다시 마운트되면서 `restore`가 호출돼서 상태를 복구해.

**쓸 때 꿀팁 및 주의사항:**
*   **진짜 '임시' 상태에만 써라:** 중요한 데이터, 영구적으로 보존해야 할 데이터는 스냅샷에 넣으면 안 돼. 이건 말 그대로 '휘발성' 기억 장치야. 브라우저 껐다 켜거나, 히스토리 날리면 같이 사라져. "중요한 건 금고에 넣어, 주머니에 넣지 말고."
*   **데이터 크기는 작게:** 스냅샷에 너무 큰 데이터를 저장하면 브라우저 히스토리 관리에 부담을 줄 수 있고, 성능에도 안 좋아. 꼭 필요한 최소한의 정보만 저장하는 게 국룰.
*   **민감 정보는 절대 금지:** 스냅샷 데이터는 브라우저에 저장되므로, 보안에 민감한 정보(개인정보, 비밀번호 등)는 절대 넣으면 안 돼. "비밀 일기는 여기에 쓰는 거 아니다."
*   **모든 브라우저/상황에서 100% 보장은 아닐 수 있음:** 브라우저 설정이나 사용 환경에 따라 스냅샷 기능이 예상대로 동작하지 않을 수도 있다는 점은 감안해야 해. 핵심 기능 의존도를 너무 높이면 곤란할 수 있어.
*   **`capture`와 `restore`는 짝꿍:** `capture`로 저장한 데이터 구조와 `restore`에서 기대하는 데이터 구조가 일치해야 꼬이지 않아. 타입스크립트 쓰면 이런 실수를 줄일 수 있겠지.
*   **서버 사이드 렌더링(SSR)과는 무관:** 스냅샷은 순전히 클라이언트(브라우저) 측 기능이야. 서버에서는 이 상태를 알지도 못하고 알 필요도 없어.