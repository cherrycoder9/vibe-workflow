애셋 최적화 (Optimizing assets)

웹사이트 성능에서 이미지 파일 크기 줄이는 것만큼 효과 쩌는 것도 드물죠. Svelte는 `@sveltejs/enhanced-img` 패키지로 이걸 좀 더 쉽게 할 수 있게 지원합니다. 이미지 페이지에 자세한 내용 있으니 참고하시고. 아, 그리고 Lighthouse 돌려보면 어떤 이미지가 제일 문제인지 콕 집어줍니다.

비디오 파일은 워낙에 덩치가 커서 최적화에 신경 좀 써야 합니다:
*   Handbrake 같은 툴로 비디오 압축하세요. `.webm`이나 `.mp4`처럼 웹 친화적인 포맷으로 바꾸는 것도 좋고요.
*   화면 스크롤 내려야 보이는 비디오는 `preload="none"`으로 지연 로딩할 수 있습니다 (물론 사용자가 재생 누르면 좀 느리게 시작하는 건 감수해야 함).
*   소리 없는 비디오는 FFmpeg 같은 툴로 오디오 트랙 날려버리세요. 용량 다이어트에 직빵입니다.

SvelteKit은 사용자가 페이지 방문하면 중요한 `.js`랑 `.css` 파일은 알아서 미리 로드해주는데, 폰트는 기본적으로 그렇게 안 합니다. 왜냐하면 CSS에는 언급됐지만 실제 페이지에선 안 쓰는 폰트 무게(font weight) 같은 불필요한 파일까지 다 받을 수 있거든요. 그렇다고 폰트 프리로딩이 안 중요하단 건 아니고, 제대로 하면 사이트 체감 속도가 확 달라집니다. `handle` 훅 안에서 `resolve` 함수 부를 때 폰트 포함하는 프리로드 필터 걸어주면 됩니다.

폰트 파일 크기는 폰트 서브세팅(font subsetting)으로 줄일 수 있습니다.

---

**얘 뭐 하는 애냐?**
웹사이트 로딩 속도랑 사용자 경험 조지기 싫으면 반드시 해야 하는 작업들 모음집입니다. 이미지, 비디오, 폰트 같은 리소스들 다이어트 시켜서 사이트를 가볍고 빠르게 만드는 기술들이죠. "무거운 건 죄악이다!" 이 마인드가 기본입니다.

**왜 쓰는데?**
1.  **광속 로딩:** 파일 작으면 당연히 빠르죠. 사용자 인내심은 3초를 넘기기 힘듭니다. "로딩 바만 보다 하루 다 가겠네" 소리 듣기 싫으면 필수.
2.  **사용자 만족도 (UX) 수직 상승:** 페이지 버벅거리면 바로 뒤로 가기 누릅니다. 부드러운 경험이 충성 고객을 만들죠. "이 사이트, 뭔가 빠릿빠릿한데?"
3.  **서버 비용 절감:** 트래픽 줄면 돈 아낍니다. 특히 이미지, 비디오 많이 쓰는 사이트는 체감 확 됩니다. "아낀 서버비로 치킨 사 먹자!"
4.  **검색엔진 최적화 (SEO) 보너스:** 구글이 빠른 사이트 좋아합니다. 검색 결과 상단에 노출되고 싶으면 속도는 기본 중의 기본. "느려터진 사이트는 검색 결과에서도 저만치 뒤로."

**언제 신경 써야 하냐?**
이건 특정 함수 호출하는 게 아니라, 웹사이트 개발 전 과정에 걸쳐서, 특히 빌드하고 배포하기 전에 바짝 신경 써야 할 최적화 전략들입니다.
*   **이미지/비디오:** 콘텐츠 만들거나 편집할 때부터, 아니면 빌드할 때 자동화 도구로 쫙 돌려야죠.
*   **폰트:** 처음 프로젝트 세팅할 때, CSS 만질 때, 그리고 SvelteKit의 `handle` 훅 설정할 때 손봐야 합니다.

**쓸 때 꿀팁 및 주의사항:**
*   **이미지:**
    *   **포맷 전쟁, 현명한 선택:** WebP 같은 차세대 포맷이 용량 대비 화질은 좋은데, 아직 구형 브라우저 쓰는 할아버지 컴퓨터에선 안 나올 수 있습니다. "최신 기술도 좋지만, 호환성 체크는 국룰."
    *   **압축은 적당히:** 너무 후려치면 화질 깨져서 못 봐줍니다. "용량 줄이려다 깍두기 전시회 할 거냐?"
    *   **반응형 이미지는 기본 소양:** `<img>` 태그에 `srcset`이랑 `sizes` 속성 써서 화면 크기별로 최적화된 이미지 보여주는 건 이제 매너입니다.
*   **비디오:**
    *   **자동 재생은 지뢰밭 (특히 소리 있는 거):** 사용자 데이터 순삭시키고, 공공장소에서 갑자기 소리 나면 민폐킹 등극입니다. "와이파이 아닌데 영상 자동 재생되면 뒷목 잡는다."
    *   **`preload="metadata"` 활용:** `preload="none"`은 재생 시작이 너무 답답하고, `auto`는 데이터를 미리 다 받아서 부담스러울 수 있습니다. 비디오 길이, 썸네일 같은 메타데이터만 먼저 받는 `metadata` 옵션도 고려해보세요.
*   **폰트:**
    *   **FOIT/FOUT 현상 최소화:** 폰트 로딩 중에 글자가 아예 안 보이거나(FOIT), 기본 폰트로 보이다가 갑자기 다른 폰트로 확 바뀌는(FOUT) 현상은 사용자 눈을 피로하게 만듭니다. CSS의 `font-display: swap;` 같은 속성으로 최대한 부드럽게 처리하세요.
    *   **웹폰트 용량 다이어트:** 특히 한글 폰트는 용량이 어마어마합니다. 필요한 글자만 추려서 용량 줄이는 서브세팅은 선택이 아닌 필수. "폰트 하나가 앱 용량만 하면 그게 폰트냐 흉기냐."
    *   **시스템 폰트 활용:** 사용자 컴퓨터에 이미 깔린 폰트(`local('Nanum Gothic')` 이런 식으로)를 우선 사용하게 하면 불필요한 다운로드를 줄일 수 있습니다.
*   **공통:**
    *   **게으른 로딩 (Lazy Loading):** 화면에 당장 안 보이는 이미지나 비디오는 스크롤해서 가까워졌을 때 로딩시키는 기술입니다. 초기 로딩 속도 개선에 아주 효과적. "일단 급한 불부터 끄자."
    *   **CDN은 거들 뿐:** 전 세계 어디서 접속하든 빠르게 콘텐츠를 제공하고 싶다면 CDN(Content Delivery Network) 사용을 고려하세요.
    *   **측정하고 또 측정하라:** Lighthouse, PageSpeed Insights, WebPageTest 같은 도구로 주기적으로 성능 측정하고 개선점을 찾아야 합니다. "감으로 최적화하지 마라. 숫자가 진리다."